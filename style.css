:root{
  --bg:#f6f7fb; --card:#fff; --muted:#6b7280; --ink:#111827;
  --line:#e5e7eb; --primary:#2563eb; --primary-dark:#1e40af;
}

*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
  font: 14px/1.5 system-ui,-apple-system,"Segoe UI","PingFang TC","Noto Sans TC",sans-serif}

/* ====== 首頁 ====== */
.home .home-wrap{max-width:880px;margin:56px auto;padding:0 16px}
.home h1{font-size:28px;margin:0 0 8px}
.home .sub{margin:0 0 20px;color:var(--muted)}
.home-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
.card{display:block;background:var(--card);border:1px solid var(--line);border-radius:12px;
  padding:20px;text-decoration:none;color:inherit;box-shadow:0 1px 2px rgba(0,0,0,.04)}
.card:hover{border-color:var(--primary)}
.card-title{font-size:18px;font-weight:700;margin-bottom:6px}
.card-desc{color:var(--muted)}

/* ====== 頁面框架 ====== */
.page{max-width:1600px;margin:20px auto;padding:0 12px}        /* ← 放大整體寬度 */
h1.page-title{font-size:24px;margin:10px 0 14px}

.btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);
  background:var(--card);padding:8px 14px;border-radius:10px;cursor:pointer}
.btn.primary{background:var(--primary);color:#fff;border-color:var(--primary)}
.btn.primary:hover{background:var(--primary-dark)}

.toolbar{display:flex;gap:10px;align-items:center;margin:10px 0}

/* ====== 單檔：上圖＋下表 ====== */
.card-panel{background:var(--card);border:1px solid var(--line);border-radius:12px}
.chart-wrap{padding:10px}
canvas{width:100% !important;height:520px !important}
.note{color:var(--muted);font-size:12px}

/* KPI（舊：單行） */
.kpi-line{background:var(--card);border:1px solid var(--line);border-radius:10px;
  padding:8px 10px;margin:10px 0;font-size:13px; font-variant-numeric: tabular-nums;}
.kpi-line .tag{display:inline-block;background:#f3f4f6;border:1px solid var(--line);
  border-radius:999px;padding:3px 8px;margin-right:6px;font-weight:600}

/* 單行 KPI 對齊用（等寬字 + 保留空白） */
.kpi-pre{
  font: 13px/1.6 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space: pre;
  margin: 0;
}

/* 多行盒（參數 + KPI 容器） */
.kpi-box{background:var(--card);border:1px solid var(--line);border-radius:10px;
  padding:8px 10px;margin:10px 0;font-size:13px;display:flex;flex-direction:column;gap:6px}
.kpi-box .tag{display:inline-block;background:#f3f4f6;border:1px solid var(--line);
  border-radius:999px;padding:3px 8px;margin-right:6px;font-weight:600}

/* KPI 表格（先前版本，保留相容） */
.kpi-table{width:100%;border-collapse:collapse;font-size:13px;table-layout:fixed}
.kpi-table td{padding:4px 8px;white-space:nowrap;vertical-align:middle}
.kpi-table td + td{border-left:1px solid var(--line)}
.kpi-table .label{font-weight:700}
.kpi-table .num{display:inline-block;min-width:6ch;text-align:right;font-variant-numeric:tabular-nums}

/* ====== 新：KPI 對齊 + 自動換行（批量版右側用） ====== */
.kpi-flex{
  font: 13px/1.6 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space: normal;
}
.kpi-flex .k-row{display:block;margin:2px 0}
.kpi-flex .kv{display:inline-block;vertical-align:top}
.kpi-flex .kv.c0{width: var(--w0, 16ch)}
.kpi-flex .kv.c1{width: var(--w1, 16ch)}
.kpi-flex .kv.c2{width: var(--w2, 16ch)}
.kpi-flex .kv.c3{width: var(--w3, 20ch)}
.kpi-flex .kv.c4{width: var(--w4, 20ch)}
.kpi-flex .kv.c5{width: var(--w5, 20ch)}
.kpi-flex .kv.c6{width: var(--w6, 20ch)}
.kpi-flex .kv.c7{width: var(--w7, 16ch)}
.kpi-flex .kv + .kv{margin-left:10px;padding-left:12px;position:relative}
.kpi-flex .kv + .kv::before{content:"｜";position:absolute;left:0;top:0;color:var(--muted)}
.kpi-flex .label{opacity:.9}
.kpi-flex .value{display:inline-block;min-width:6ch;text-align:right}

/* 交易表 */
.table{width:100%;border-collapse:collapse;background:var(--card);
  border:1px solid var(--line);border-radius:12px;overflow:auto;display:block}
.table thead th{position:sticky;top:0;background:#fafafa;border-bottom:1px solid var(--line);
  padding:8px 10px;font-weight:700}
.table td{border-bottom:1px solid var(--line);padding:7px 10px;text-align:center;white-space:nowrap}
.table tbody tr:nth-child(even){background:#fbfcff}

/* ====== 批量：上(圖/右側) + 下(彙總) ====== */
.top-grid{
  display:grid;
  grid-template-columns:minmax(900px,1fr) 360px;   /* ← 左大右小，圖表更寬 */
  gap:14px
}
.right-box{display:flex;flex-direction:column;gap:10px}
.right-card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:10px}

.params-line{padding:6px 8px;border-radius:8px;background:#f9fafb;border:1px solid var(--line);font-size:13px}
.params-line .chip{display:inline-block;margin:0 3px}

.scroll{max-height:340px;overflow:auto;border:1px solid var(--line);border-radius:10px;background:var(--card)}
.scroll table{border:0;border-collapse:collapse;width:100%}
.scroll th,.scroll td{white-space:nowrap;padding:7px 8px;border-bottom:1px solid var(--line);text-align:center}
.scroll thead th{background:#fafafa;position:sticky;top:0}

.sum-wrap{margin-top:14px}
.sum-table{display:block;overflow:auto;border:1px solid var(--line);border-radius:12px;background:var(--card)}
.sum-table table{border-collapse:collapse;width:max-content;min-width:100%}
.sum-table th,.sum-table td{border-bottom:1px solid var(--line);padding:8px 10px;white-space:nowrap;text-align:center}
.sum-table thead th{background:#fafafa;position:sticky;top:0;cursor:pointer}
.sum-table tbody tr:hover{background:#f6faff}
.row-link{color:#2563eb;cursor:pointer;text-decoration:underline}
.nowrap{white-space:nowrap}
.hidden{display:none !important}
